{% extends 'LoginCidadaoCoreBundle::base.html.twig' %}

{% block header %}{% endblock header %}
{% block notificationExtreme %}{% endblock notificationExtreme %}
{% block footer %}{% endblock footer %}

{% block body %}
    <div class="row">
        <div class="col-sm-6 col-sm-offset-3 col-lg-4 col-lg-offset-4 well">
            <h1>{{ 'Two-Factor Authentication' | trans }}</h1>
            <p>{% trans %}Enter the code generated by your code generator device.{% endtrans %}</p>
            <form class="form" action="" method="post" role="form">
                {% for flashMessage in app.session.flashbag.get("two_factor") %}
                    <p class="error">{{ flashMessage|trans }}</p>
                {% endfor %}

                <div class="form-group">
                    <label for="_auth_code" class="sr-only">{{ "Authentication Code"|trans }}</label>
                    <input id="_auth_code" type="text" autocomplete="off" name="_auth_code" class="form-control" placeholder="{{ "Authentication Code"|trans }}" />
                </div>
                
                {% if useTrustedOption %}<div class="checkbox">
                        <label for="_trusted">
                            <input id="_trusted" type="checkbox" name="_trusted" />
                            {{ "scheb_two_factor.trusted"|trans }}
                        </label>
                    </div>{% endif %}
                    
                    <button type="submit" class="btn btn-success pull-right">{{ 'security.login.submit'|trans }}</button>

                {# The logout link gives the user a way out if they can't complete the second step #}
                <a class="btn btn-link pull-left" href="{{ path("fos_user_security_logout") }}">{{ 'Cancel' | trans }}</a>
            </form>
        </div>
    </div>
{% endblock body %}

{% block javascripts %}
    {{ parent() }}
    <script>
        $(document).ready(function(){
            $('form').preventDoubleSubmission();
        });
    </script>
{% endblock %}

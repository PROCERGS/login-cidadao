{% extends "LoginCidadaoCoreBundle::base.loggedIn.html.twig" %}


{% block title %}{{ 'Enable Two-Factor Authentication' | trans }} | {{ parent() }}{% endblock title %}

{% block content %}
    <div class="content two-factor-authentication-enable clearfix">
        <h1 class="visible-xs">{%trans%}Enable Two-Factor Authentication{%endtrans%}</h1>


        {{ form_start(form, { 'attr': {'role':'form', 'class':'lc_change_password' } }) }}
        {{ form_errors(form) }}
        <div class="form-content">
            {% if is_granted('FEATURE_2FACTOR_AUTH') %}
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h2 class="panel-title">{{ 'Two-Factor Authentication Activation' | trans }}</h2>
                    </div>
                    <div class="panel-body">
                        <div class="row clearfix">
                            <div class="col-md-12">
                                <p>{{ 'Two-Factor Authentication is a form of authentication that requires a secret code to be typed after you enter your password.' | trans }}</p>
                                <p>{{ 'The secret code can only be generated by a single device that you own and carry with you and it has a limited lifetime. This way even if someone steals your password, your account will still be protected by that code.' | trans }}</p>

                                <h3>{{ 'Enabling Two-Factor Authentication' | trans }}</h3>
                                <p>{{ 'Before you start, make sure to download and install some code generation app onto your smartphone. If you don\'t know any, we can recommend you Google\'s Authenticator app.' | trans }}</p>
                                <p>{{ 'Having the app installed, open it and select the option to add a new service and scan the QRCode below or you can type the secret manually if your app of choice does not have a QRCode scanner.' | trans }}</p>

                                <div class="two-factor-qrcode text-center">
                                    <img src="{{ secretUrl }}" />
                                </div>
                                {{ form_row(form.googleAuthenticatorSecret) }}

                                <p>{% trans %}After you finish configuring your code generator app, type the generated code below so that we can make sure it's working correctly.{% endtrans %}</p>
                                {{ form_row(form.verification) }}

                                {% if form.current_password is defined %}
                                    <p>{% trans %}Type your password to confirm the activation.{% endtrans %}</p>
                                    {{ form_row(form.current_password) }}
                                {% else %}
                                    <p>{% trans %}You don't have a password yet. Please create one below. This password can be used to login using your email or username.{% endtrans %}</p>
                                    {{ form_row(form.password) }}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="panel-footer text-right">
                        {{ form_row(form.enable) }}
                    </div>
                </div>
            {% endif %}
            {{ form_end(form) }}
        </div>
    </div>
{% endblock %}

